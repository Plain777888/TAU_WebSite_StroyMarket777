
<!--#НАЧАЛО-->
<!--{% extends 'store/base.html' %}-->

<!--{% block title %}{{ product.name }} - Строительный магазин{% endblock %}-->
<!--<style>-->
<!--        /* Основные стили */-->
<!--        .product-container {-->
<!--            max-width: 1200px;-->
<!--            margin: 0 auto;-->
<!--            padding: 20px;-->
<!--        }-->

<!--        .product-main {-->
<!--            display: flex;-->
<!--            flex-wrap: wrap;-->
<!--            gap: 40px;-->
<!--            margin-bottom: 40px;-->
<!--        }-->

<!--        .product-images {-->
<!--            flex: 1;-->
<!--            min-width: 300px;-->
<!--        }-->

<!--        .product-info {-->
<!--            flex: 1;-->
<!--            min-width: 300px;-->
<!--        }-->

<!--        /* Галерея - основной блок */-->
<!--        .gallery {-->
<!--            position: relative;-->
<!--        }-->

<!--        /* Основное изображение с кнопками навигации */-->
<!--        .main-image-container {-->
<!--            position: relative;-->
<!--            margin-bottom: 20px;-->
<!--            border: 1px solid #ddd;-->
<!--            border-radius: 8px;-->
<!--            overflow: hidden;-->
<!--            background: #f9f9f9;-->
<!--            min-height: 400px;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            justify-content: center;-->
<!--        }-->

<!--        .main-image {-->
<!--            max-width: 100%;-->
<!--            max-height: 500px;-->
<!--            object-fit: contain;-->
<!--            cursor: zoom-in;-->
<!--            transition: transform 0.3s;-->
<!--        }-->

<!--        .main-image:hover {-->
<!--            transform: scale(1.01);-->
<!--        }-->

<!--        /* Кнопки навигации по бокам */-->
<!--        .nav-btn {-->
<!--            position: absolute;-->
<!--            top: 50%;-->
<!--            transform: translateY(-50%);-->
<!--            background: rgba(255, 255, 255, 0.9);-->
<!--            border: none;-->
<!--            width: 50px;-->
<!--            height: 50px;-->
<!--            border-radius: 50%;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            justify-content: center;-->
<!--            cursor: pointer;-->
<!--            font-size: 24px;-->
<!--            color: #333;-->
<!--            box-shadow: 0 2px 10px rgba(0,0,0,0.1);-->
<!--            transition: all 0.3s;-->
<!--            z-index: 10;-->
<!--        }-->

<!--        .nav-btn:hover {-->
<!--            background: white;-->
<!--            box-shadow: 0 4px 15px rgba(0,0,0,0.2);-->
<!--            transform: translateY(-50%) scale(1.1);-->
<!--        }-->

<!--        .nav-btn.prev {-->
<!--            left: 20px;-->
<!--        }-->

<!--        .nav-btn.next {-->
<!--            right: 20px;-->
<!--        }-->

<!--        .nav-btn:disabled {-->
<!--            opacity: 0.3;-->
<!--            cursor: not-allowed;-->
<!--            transform: translateY(-50%) scale(1);-->
<!--        }-->

<!--        .nav-btn:disabled:hover {-->
<!--            background: rgba(255, 255, 255, 0.9);-->
<!--            box-shadow: 0 2px 10px rgba(0,0,0,0.1);-->
<!--        }-->

<!--        /* Счетчик изображений */-->
<!--        .image-counter {-->
<!--            position: absolute;-->
<!--            bottom: 15px;-->
<!--            left: 50%;-->
<!--            transform: translateX(-50%);-->
<!--            background: rgba(0, 0, 0, 0.7);-->
<!--            color: white;-->
<!--            padding: 5px 15px;-->
<!--            border-radius: 20px;-->
<!--            font-size: 14px;-->
<!--            z-index: 5;-->
<!--        }-->

<!--        /* Миниатюры */-->
<!--        .thumbnails {-->
<!--            display: flex;-->
<!--            gap: 10px;-->
<!--            overflow-x: auto;-->
<!--            padding: 10px 0;-->
<!--            scrollbar-width: thin;-->
<!--        }-->

<!--        .thumbnail {-->
<!--            width: 80px;-->
<!--            height: 80px;-->
<!--            object-fit: cover;-->
<!--            border: 2px solid transparent;-->
<!--            border-radius: 4px;-->
<!--            cursor: pointer;-->
<!--            flex-shrink: 0;-->
<!--            transition: all 0.3s;-->
<!--        }-->

<!--        .thumbnail:hover {-->
<!--            border-color: #3498db;-->
<!--            transform: translateY(-2px);-->
<!--        }-->

<!--        .thumbnail.active {-->
<!--            border-color: #e74c3c;-->
<!--        }-->

<!--        /* Модальное окно для полноэкранного просмотра */-->
<!--        .modal-overlay {-->
<!--            display: none;-->
<!--            position: fixed;-->
<!--            top: 0;-->
<!--            left: 0;-->
<!--            right: 0;-->
<!--            bottom: 0;-->
<!--            background: rgba(0, 0, 0, 0.9);-->
<!--            z-index: 1000;-->
<!--            align-items: center;-->
<!--            justify-content: center;-->
<!--        }-->

<!--        .modal-image-container {-->
<!--            position: relative;-->
<!--            max-width: 90%;-->
<!--            max-height: 90%;-->
<!--        }-->

<!--        .modal-image {-->
<!--            max-width: 100%;-->
<!--            max-height: 90vh;-->
<!--            object-fit: contain;-->
<!--        }-->

<!--        .modal-close {-->
<!--            position: absolute;-->
<!--            top: -40px;-->
<!--            right: 0;-->
<!--            background: none;-->
<!--            border: none;-->
<!--            color: white;-->
<!--            font-size: 30px;-->
<!--            cursor: pointer;-->
<!--            padding: 5px;-->
<!--        }-->

<!--        .modal-nav-btn {-->
<!--            position: absolute;-->
<!--            top: 50%;-->
<!--            transform: translateY(-50%);-->
<!--            background: rgba(255, 255, 255, 0.2);-->
<!--            border: none;-->
<!--            color: white;-->
<!--            width: 60px;-->
<!--            height: 60px;-->
<!--            border-radius: 50%;-->
<!--            font-size: 30px;-->
<!--            cursor: pointer;-->
<!--            transition: background 0.3s;-->
<!--        }-->

<!--        .modal-nav-btn:hover {-->
<!--            background: rgba(255, 255, 255, 0.3);-->
<!--        }-->

<!--        .modal-nav-btn.prev {-->
<!--            left: 20px;-->
<!--        }-->

<!--        .modal-nav-btn.next {-->
<!--            right: 20px;-->
<!--        }-->

<!--        .modal-counter {-->
<!--            position: absolute;-->
<!--            bottom: -40px;-->
<!--            left: 0;-->
<!--            right: 0;-->
<!--            text-align: center;-->
<!--            color: white;-->
<!--            font-size: 16px;-->
<!--        }-->

<!--        /* Информация о товаре */-->
<!--        .product-price {-->
<!--            color: #e74c3c;-->
<!--            font-size: 28px;-->
<!--            font-weight: bold;-->
<!--            margin: 20px 0;-->
<!--        }-->

<!--        .stock-status {-->
<!--            padding: 8px 12px;-->
<!--            border-radius: 4px;-->
<!--            font-weight: bold;-->
<!--            display: inline-block;-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .in-stock {-->
<!--            background: #d4edda;-->
<!--            color: #155724;-->
<!--        }-->

<!--        .out-of-stock {-->
<!--            background: #f8d7da;-->
<!--            color: #721c24;-->
<!--        }-->

<!--        .add-to-cart {-->
<!--            display: flex;-->
<!--            gap: 10px;-->
<!--            margin: 20px 0;-->
<!--            align-items: center;-->
<!--        }-->

<!--        .quantity-input {-->
<!--            width: 80px;-->
<!--            padding: 10px;-->
<!--            border: 1px solid #ddd;-->
<!--            border-radius: 4px;-->
<!--        }-->

<!--        .add-to-cart-btn {-->
<!--            padding: 12px 24px;-->
<!--            background: #3498db;-->
<!--            color: white;-->
<!--            border: none;-->
<!--            border-radius: 4px;-->
<!--            cursor: pointer;-->
<!--            font-size: 16px;-->
<!--            transition: background 0.3s;-->
<!--        }-->

<!--        .add-to-cart-btn:hover {-->
<!--            background: #2980b9;-->
<!--        }-->

<!--        .add-to-cart-btn:disabled {-->
<!--            background: #95a5a6;-->
<!--            cursor: not-allowed;-->
<!--        }-->

<!--        /* Адаптивность */-->
<!--        @media (max-width: 768px) {-->
<!--            .product-main {-->
<!--                flex-direction: column;-->
<!--            }-->

<!--            .main-image-container {-->
<!--                min-height: 300px;-->
<!--            }-->

<!--            .nav-btn {-->
<!--                width: 40px;-->
<!--                height: 40px;-->
<!--                font-size: 20px;-->
<!--            }-->

<!--            .thumbnail {-->
<!--                width: 60px;-->
<!--                height: 60px;-->
<!--            }-->

<!--            .modal-nav-btn {-->
<!--                width: 40px;-->
<!--                height: 40px;-->
<!--                font-size: 20px;-->
<!--            }-->
<!--        }-->
<!--    </style>-->
<!--{% block content %}-->
<!--<div class="container mt-4">-->
<!--    &lt;!&ndash; Хлебные крошки &ndash;&gt;-->
<!--    <nav aria-label="breadcrumb">-->
<!--        <ol class="breadcrumb">-->
<!--            <li class="breadcrumb-item"><a href="{% url 'store:index' %}">Главная</a></li>-->
<!--            <li class="breadcrumb-item"><a href="{{ product.category.get_absolute_url }}">{{ product.category.name }}</a></li>-->
<!--            <li class="breadcrumb-item active">{{ product.name|truncatechars:30 }}</li>-->
<!--        </ol>-->
<!--    </nav>-->

<!--    <div class="product-main">-->
<!--            &lt;!&ndash; Блок с галереей &ndash;&gt;-->
<!--            <div class="product-images">-->
<!--                <div class="gallery">-->
<!--                    &lt;!&ndash; Основное изображение с кнопками навигации &ndash;&gt;-->
<!--                    <div class="main-image-container">-->
<!--    <div class="row">-->
<!--        &lt;!&ndash; Изображение товара &ndash;&gt;-->
<!--        <div class="col-md-6">-->
<!--            <div class="card mb-4 border-0 shadow-sm">-->
<!--                {% if product.get_main_image or product_images %}-->
<!--                <img id="mainImage" src="{{ product.get_main_image }}" onclick="openModal()" class="card-img-top" alt="{{ product.name }}" style="max-height: 400px; object-fit: contain;">-->
<!--                &lt;!&ndash; Кнопки навигации &ndash;&gt;-->
<!--                            <button class="nav-btn prev" onclick="prevImage()" id="prevBtn">‹</button>-->
<!--                            <button class="nav-btn next" onclick="nextImage()" id="nextBtn">›</button>-->

<!--                            &lt;!&ndash; Счетчик &ndash;&gt;-->
<!--                            <div class="image-counter" id="imageCounter">1 / {{ product_images|length|add:1 }}</div>-->
<!--                {% else %}-->
<!--                <div class="card-img-top d-flex align-items-center justify-content-center bg-light" style="height: 400px;">-->
<!--                    <i class="bi bi-image text-muted" style="font-size: 5rem;"></i>-->
<!--                </div>-->
<!--                {% endif %}-->
<!--                &lt;!&ndash; Миниатюры &ndash;&gt;-->
<!--                {% if product.get_main_image or product_images %}-->
<!--                    <div class="thumbnails" id="thumbnailsContainer">-->
<!--                        &lt;!&ndash; Основное изображение как миниатюра &ndash;&gt;-->
<!--                        {% if product.get_main_image %}-->
<!--                        <img src="{{ product.get_main_image }}"-->
<!--                             alt="{{ product.name }}"-->
<!--                             class="thumbnail active"-->
<!--                             data-index="0"-->
<!--                             onclick="showImage(0, '{{ product.get_main_image }}', '{{ product.name }}')">-->
<!--                        {% endif %}-->
<!--                        &lt;!&ndash; Дополнительные изображения &ndash;&gt;-->
<!--                        {% for image in product_images %}-->
<!--                            {% if image.get_image_url %}-->
<!--                            <img src="{{ image.get_image_url }}"-->
<!--                                 alt="{{ image.alt_text|default:product.name }}"-->
<!--                                 class="thumbnail {% if not product.get_main_image and forloop.first %}active{% endif %}"-->
<!--                                 data-index="{{ forloop.counter0|add:1 }}"-->
<!--                                 onclick="showImage({{ forloop.counter0|add:1 }}, '{{ image.get_image_url }}', '{{ image.alt_text|default:product.name }}')">-->
<!--                            {% endif %}-->
<!--                        {% endfor %}-->
<!--&lt;!&ndash;                <div class="card-body">&ndash;&gt;-->
<!--&lt;!&ndash;                    <div class="row">&ndash;&gt;-->
<!--&lt;!&ndash;                        {% for image in product.images.all %}&ndash;&gt;-->
<!--&lt;!&ndash;                        <div class="col-3">&ndash;&gt;-->
<!--&lt;!&ndash;                            <img src="{{ image.get_image_url }}" class="img-thumbnail" alt="{{ image.alt_text }}" style="height: 80px; object-fit: cover;">&ndash;&gt;-->
<!--&lt;!&ndash;                        </div>&ndash;&gt;-->
<!--&lt;!&ndash;                        {% endfor %}&ndash;&gt;-->
<!--                        </div>-->
<!--                        {% endif %}-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; Информация о товаре &ndash;&gt;-->
<!--        <div class="col-md-6">-->
<!--            <h1 class="mb-3">{{ product.name }}</h1>-->
<!--            -->
<!--            {% if product.brand %}-->
<!--            <p class="text-muted">Бренд: <strong>{{ product.brand }}</strong></p>-->
<!--            {% endif %}-->
<!--            -->
<!--            <div class="mb-3">-->
<!--                <span class="h2 text-primary">{{ product.price }} ₽</span>-->
<!--                <span class="text-muted">/ {{ product.get_unit_display }}</span>-->
<!--            </div>-->

<!--            &lt;!&ndash; Наличие &ndash;&gt;-->
<!--            <div class="mb-3">-->
<!--                {% if product.available and product.stock > 0 %}-->
<!--                <span class="badge bg-success">В наличии</span>-->
<!--                <small class="text-muted">(Остаток: {{ product.stock }} {{ product.get_unit_display }})</small>-->
<!--                {% elif product.available and product.stock == 0 %}-->
<!--                <span class="badge bg-warning">Под заказ</span>-->
<!--                {% else %}-->
<!--                <span class="badge bg-danger">Нет в наличии</span>-->
<!--                {% endif %}-->
<!--            </div>-->

<!--            &lt;!&ndash; Кнопки действий &ndash;&gt;-->
<!--            <div class="mb-4">-->
<!--                {% if product.available and product.stock > 0 %}-->
<!--                <a href="{% url 'store:add_to_cart' product.id %}" class="btn btn-primary btn-lg w-100 mb-2">-->
<!--                    <i class="bi bi-cart-plus"></i> Добавить в корзину-->
<!--                </a>-->
<!--                {% else %}-->
<!--                <button class="btn btn-secondary btn-lg w-100 mb-2" disabled>-->
<!--                    Товар недоступен-->
<!--                </button>-->
<!--                {% endif %}-->
<!--                -->
<!--                <button class="btn btn-outline-secondary w-100">-->
<!--                    <i class="bi bi-heart"></i> В избранное-->
<!--                </button>-->
<!--            </div>-->

<!--            &lt;!&ndash; Характеристики &ndash;&gt;-->
<!--            <div class="card mb-4 border-0 shadow-sm">-->
<!--                <div class="card-header bg-light">-->
<!--                    <h5 class="mb-0">Характеристики</h5>-->
<!--                </div>-->
<!--                <div class="card-body">-->
<!--                    <table class="table table-sm">-->
<!--                        <tbody>-->
<!--                            {% if product.material %}-->
<!--                            <tr>-->
<!--                                <th scope="row">Материал</th>-->
<!--                                <td>{{ product.material }}</td>-->
<!--                            </tr>-->
<!--                            {% endif %}-->
<!--                            {% if product.color %}-->
<!--                            <tr>-->
<!--                                <th scope="row">Цвет</th>-->
<!--                                <td>{{ product.color }}</td>-->
<!--                            </tr>-->
<!--                            {% endif %}-->
<!--                            {% if product.weight %}-->
<!--                            <tr>-->
<!--                                <th scope="row">Вес</th>-->
<!--                                <td>{{ product.weight }} кг</td>-->
<!--                            </tr>-->
<!--                            {% endif %}-->
<!--                            {% if product.dimensions %}-->
<!--                            <tr>-->
<!--                                <th scope="row">Габариты</th>-->
<!--                                <td>{{ product.dimensions }}</td>-->
<!--                            </tr>-->
<!--                            {% endif %}-->
<!--                            <tr>-->
<!--                                <th scope="row">Категория</th>-->
<!--                                <td><a href="{{ product.category.get_absolute_url }}">{{ product.category.name }}</a></td>-->
<!--                            </tr>-->
<!--                        </tbody>-->
<!--                    </table>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Описание товара &ndash;&gt;-->
<!--    <div class="row mt-4">-->
<!--        <div class="col-12">-->
<!--            <div class="card border-0 shadow-sm">-->
<!--                <div class="card-header bg-light">-->
<!--                    <h5 class="mb-0">Описание товара</h5>-->
<!--                </div>-->
<!--                <div class="card-body">-->
<!--                    <p>{{ product.description|linebreaks }}</p>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    &lt;!&ndash; Модальное окно для полноэкранного просмотра &ndash;&gt;-->
<!--        <div class="modal-overlay" id="imageModal" onclick="closeModal(event)">-->
<!--            <div class="modal-image-container">-->
<!--                <button class="modal-close" onclick="closeModal()">×</button>-->

<!--                <img id="modalImage" class="modal-image" src="" alt="">-->

<!--                <button class="modal-nav-btn prev" onclick="modalPrevImage(event)">‹</button>-->
<!--                <button class="modal-nav-btn next" onclick="modalNextImage(event)">›</button>-->

<!--                <div class="modal-counter" id="modalCounter"></div>-->
<!--            </div>-->
<!--        </div>-->
<!--    &lt;!&ndash; Похожие товары &ndash;&gt;-->
<!--    {% if related_products %}-->
<!--    <div class="row mt-5">-->
<!--        <div class="col-12">-->
<!--            <h3>Похожие товары</h3>-->
<!--            <div class="row">-->
<!--                {% for related in related_products %}-->
<!--                <div class="col-md-3 mb-4">-->
<!--                    <div class="card product-card border-0 shadow-sm h-100">-->
<!--                        {% if related.image %}-->
<!--                        <img src="{{ related.get_main_image }}" class="card-img-top product-img" alt="{{ related.name }}" style="height: 150px; object-fit: cover;">-->
<!--                        {% endif %}-->
<!--                        <div class="card-body d-flex flex-column">-->
<!--                            <h6 class="card-title">{{ related.name|truncatechars:40 }}</h6>-->
<!--                            <div class="mt-auto">-->
<!--                                <p class="h6 text-primary">{{ related.price }} ₽</p>-->
<!--                                <a href="{{ related.get_main_image }}" class="btn btn-outline-primary btn-sm w-100">Подробнее</a>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                {% endfor %}-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    {% endif %}-->
<!--     <script>-->
<!--    // Все изображения товара-->
<!--    let images = [];-->
<!--    let currentIndex = 0;-->

<!--    // Инициализация при загрузке страницы-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        // Собираем все изображения товара-->
<!--        const thumbnails = document.querySelectorAll('.thumbnail');-->

<!--        // Основное изображение-->
<!--        const mainImage = document.getElementById('mainImage');-->
<!--        if (mainImage && mainImage.src) {-->
<!--            images.push({-->
<!--                src: mainImage.src,-->
<!--                alt: mainImage.alt-->
<!--            });-->
<!--        }-->

<!--        // Дополнительные изображения-->
<!--        thumbnails.forEach((thumb, index) => {-->
<!--            if (index > 0) { // Первая миниатюра - это основное изображение-->
<!--                images.push({-->
<!--                    src: thumb.src,-->
<!--                    alt: thumb.alt-->
<!--                });-->
<!--            }-->
<!--        });-->

<!--        // Обновляем счетчик-->
<!--        updateCounter();-->
<!--        updateNavButtons();-->
<!--    });-->

<!--    // Показать определенное изображение-->
<!--    function showImage(index, src, alt) {-->
<!--        currentIndex = parseInt(index);-->

<!--        // Обновляем основное изображение-->
<!--        const mainImage = document.getElementById('mainImage');-->
<!--        mainImage.src = src;-->
<!--        mainImage.alt = alt;-->

<!--        // Обновляем активную миниатюру-->
<!--        document.querySelectorAll('.thumbnail').forEach(thumb => {-->
<!--            thumb.classList.remove('active');-->
<!--        });-->
<!--        document.querySelector(`.thumbnail[data-index="${index}"]`).classList.add('active');-->

<!--        // Обновляем счетчик и кнопки-->
<!--        updateCounter();-->
<!--        updateNavButtons();-->
<!--    }-->

<!--    // Следующее изображение-->
<!--    function nextImage() {-->
<!--        if (currentIndex < images.length - 1) {-->
<!--            currentIndex++;-->
<!--            const thumbnail = document.querySelector(`.thumbnail[data-index="${currentIndex}"]`);-->
<!--            showImage(currentIndex, thumbnail.src, thumbnail.alt);-->
<!--        }-->
<!--    }-->

<!--    // Предыдущее изображение-->
<!--    function prevImage() {-->
<!--        if (currentIndex > 0) {-->
<!--            currentIndex&#45;&#45;;-->
<!--            const thumbnail = document.querySelector(`.thumbnail[data-index="${currentIndex}"]`);-->
<!--            showImage(currentIndex, thumbnail.src, thumbnail.alt);-->
<!--        }-->
<!--    }-->

<!--    // Обновить счетчик-->
<!--    function updateCounter() {-->
<!--        const counter = document.getElementById('imageCounter');-->
<!--        if (counter && images.length > 0) {-->
<!--            counter.textContent = `${currentIndex + 1} / ${images.length}`;-->
<!--        }-->
<!--    }-->

<!--    // Обновить состояние кнопок навигации-->
<!--    function updateNavButtons() {-->
<!--        const prevBtn = document.getElementById('prevBtn');-->
<!--        const nextBtn = document.getElementById('nextBtn');-->

<!--        if (prevBtn) prevBtn.disabled = currentIndex === 0;-->
<!--        if (nextBtn) nextBtn.disabled = currentIndex === images.length - 1;-->
<!--    }-->

<!--    // Открыть модальное окно-->
<!--    function openModal() {-->
<!--        if (images.length === 0) return;-->

<!--        const modal = document.getElementById('imageModal');-->
<!--        const modalImage = document.getElementById('modalImage');-->
<!--        const modalCounter = document.getElementById('modalCounter');-->

<!--        modalImage.src = images[currentIndex].src;-->
<!--        modalImage.alt = images[currentIndex].alt;-->
<!--        modalCounter.textContent = `${currentIndex + 1} / ${images.length}`;-->

<!--        modal.style.display = 'flex';-->
<!--        document.body.style.overflow = 'hidden'; // Блокируем скролл-->
<!--    }-->

<!--    // Закрыть модальное окно-->
<!--    function closeModal(event) {-->
<!--        // Закрываем только если кликнули на overlay или кнопку закрытия-->
<!--        if (event && event.target.classList.contains('modal-image-container')) {-->
<!--            return;-->
<!--        }-->

<!--        const modal = document.getElementById('imageModal');-->
<!--        modal.style.display = 'none';-->
<!--        document.body.style.overflow = 'auto'; // Возвращаем скролл-->
<!--    }-->

<!--    // Навигация в модальном окне-->
<!--    function modalNextImage(event) {-->
<!--        event.stopPropagation();-->
<!--        if (currentIndex < images.length - 1) {-->
<!--            currentIndex++;-->
<!--            updateModalImage();-->
<!--        }-->
<!--    }-->

<!--    function modalPrevImage(event) {-->
<!--        event.stopPropagation();-->
<!--        if (currentIndex > 0) {-->
<!--            currentIndex&#45;&#45;;-->
<!--            updateModalImage();-->
<!--        }-->
<!--    }-->

<!--    // Обновить изображение в модальном окне-->
<!--    function updateModalImage() {-->
<!--        const modalImage = document.getElementById('modalImage');-->
<!--        const modalCounter = document.getElementById('modalCounter');-->
<!--        const mainImage = document.getElementById('mainImage');-->

<!--        modalImage.src = images[currentIndex].src;-->
<!--        modalImage.alt = images[currentIndex].alt;-->
<!--        modalCounter.textContent = `${currentIndex + 1} / ${images.length}`;-->

<!--        // Также обновляем основное изображение на странице-->
<!--        mainImage.src = images[currentIndex].src;-->
<!--        mainImage.alt = images[currentIndex].alt;-->

<!--        // Обновляем активную миниатюру-->
<!--        document.querySelectorAll('.thumbnail').forEach(thumb => {-->
<!--            thumb.classList.remove('active');-->
<!--        });-->
<!--        document.querySelector(`.thumbnail[data-index="${currentIndex}"]`).classList.add('active');-->

<!--        updateCounter();-->
<!--        updateNavButtons();-->
<!--    }-->

<!--    // Управление с клавиатуры-->
<!--    document.addEventListener('keydown', function(event) {-->
<!--        const modal = document.getElementById('imageModal');-->

<!--        if (modal.style.display === 'flex') {-->
<!--            // В модальном окне-->
<!--            switch(event.key) {-->
<!--                case 'Escape':-->
<!--                    closeModal();-->
<!--                    break;-->
<!--                case 'ArrowLeft':-->
<!--                    modalPrevImage({ stopPropagation: () => {} });-->
<!--                    break;-->
<!--                case 'ArrowRight':-->
<!--                    modalNextImage({ stopPropagation: () => {} });-->
<!--                    break;-->
<!--            }-->
<!--        } else {-->
<!--            // На основной странице-->
<!--            switch(event.key) {-->
<!--                case 'ArrowLeft':-->
<!--                    prevImage();-->
<!--                    break;-->
<!--                case 'ArrowRight':-->
<!--                    nextImage();-->
<!--                    break;-->
<!--                case ' ':-->
<!--                case 'Enter':-->
<!--                    openModal();-->
<!--                    break;-->
<!--            }-->
<!--        }-->
<!--    });-->

<!--    // Swipe для мобильных устройств-->
<!--    let touchStartX = 0;-->
<!--    let touchEndX = 0;-->

<!--    document.getElementById('imageModal')?.addEventListener('touchstart', function(event) {-->
<!--        touchStartX = event.changedTouches[0].screenX;-->
<!--    });-->

<!--    document.getElementById('imageModal')?.addEventListener('touchend', function(event) {-->
<!--        touchEndX = event.changedTouches[0].screenX;-->
<!--        handleSwipe();-->
<!--    });-->

<!--    function handleSwipe() {-->
<!--        const swipeThreshold = 50;-->

<!--        if (touchEndX < touchStartX - swipeThreshold) {-->
<!--            // Swipe влево - следующее изображение-->
<!--            modalNextImage({ stopPropagation: () => {} });-->
<!--        } else if (touchEndX > touchStartX + swipeThreshold) {-->
<!--            // Swipe вправо - предыдущее изображение-->
<!--            modalPrevImage({ stopPropagation: () => {} });-->
<!--        }-->
<!--    }-->
<!--    </script>-->

<!--{% endblock %}-->

<!--#КОНЕЦ-->